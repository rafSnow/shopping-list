# Documento de Arquitetura de Software

## App de Lista de Compras Compartilhada

**Vers√£o:** 2.0
**Data:** 17 de outubro de 2025
**Arquitetura:** Firebase + Vercel (100% Gratuita)

---

## 1. Vis√£o Geral da Arquitetura

### 1.1 Arquitetura Geral

O sistema segue uma arquitetura **Serverless BaaS (Backend as a Service)** totalmente gratuita:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      CAMADA CLIENTE                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   React Native App (Expo)  ‚îÇ   React Web App (Vercel)            ‚îÇ
‚îÇ   (iOS + Android)          ‚îÇ   (Navegadores)                     ‚îÇ
‚îÇ   ‚úì Gratuito               ‚îÇ   ‚úì Gratuito                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚Üï HTTPS (Firebase SDK)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FIREBASE SERVICES (Gratuito)                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ Firestore    ‚îÇ  Authentication   ‚îÇ  Cloud Storage   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ (Database)   ‚îÇ  (Auth)           ‚îÇ  (Files)         ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ Real-time    ‚îÇ  Anonymous/Email  ‚îÇ  5GB             ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ 50k/dia      ‚îÇ  10k/m√™s          ‚îÇ  1GB/dia         ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 1.2 Estilo Arquitetural

- **Backend:** BaaS (Backend as a Service) - Serverless
- **Frontend:** Component-Based Architecture (React/React Native)
- **Comunica√ß√£o:** Firebase SDK (Real-time Database/Firestore)
- **Dados:** Offline-First nativo com sincroniza√ß√£o autom√°tica
- **Hospedagem Web:** Vercel (CDN Global)
- **Hospedagem Mobile:** Expo (Build e distribui√ß√£o gratuita)

---

## 2. Componentes do Sistema

### 2.1 Firebase Backend (Serverless)

#### 2.1.1 Cloud Firestore (Database)

```
shopping-list (Collection)
‚îú‚îÄ‚îÄ items (Collection)
‚îÇ   ‚îî‚îÄ‚îÄ {itemId} (Document)
‚îÇ       ‚îú‚îÄ‚îÄ id: string (auto-generated)
‚îÇ       ‚îú‚îÄ‚îÄ name: string
‚îÇ       ‚îú‚îÄ‚îÄ createdAt: timestamp
‚îÇ       ‚îú‚îÄ‚îÄ updatedAt: timestamp
‚îÇ       ‚îî‚îÄ‚îÄ deleted: boolean
```

**Caracter√≠sticas:**

- ‚úÖ Real-time sincroniza√ß√£o autom√°tica
- ‚úÖ Offline persistence nativa
- ‚úÖ 50k leituras/dia (gratuito)
- ‚úÖ 20k escritas/dia (gratuito)
- ‚úÖ 1GB armazenamento (gratuito)

#### 2.1.2 Firebase Authentication (Opcional)

```
M√©todos dispon√≠veis:
‚îú‚îÄ‚îÄ Anonymous (recomendado para MVP)
‚îú‚îÄ‚îÄ Email/Password
‚îî‚îÄ‚îÄ Google Sign-In
```

**Caracter√≠sticas:**

- ‚úÖ 10k autentica√ß√µes/m√™s (gratuito)
- ‚úÖ Configura√ß√£o simples
- ‚úÖ Seguran√ßa integrada

#### 2.1.3 Firebase Security Rules

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /items/{itemId} {
      // Permitir leitura e escrita para todos (MVP)
      allow read, write: if true;

      // Para produ√ß√£o com autentica√ß√£o:
      // allow read: if request.auth != null;
      // allow create: if request.auth != null && validateItem();
      // allow update, delete: if request.auth != null;
    }
  }
}
```

### 2.2 Frontend Mobile - React Native (Expo)

```
shopping-list-mobile/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ItemList.tsx          (Lista de itens)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ItemInput.tsx         (Campo de entrada)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ItemCard.tsx          (Card individual)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ClearButton.tsx       (Bot√£o limpar)
‚îÇ   ‚îú‚îÄ‚îÄ screens/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HomeScreen.tsx        (Tela principal)
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ firebase.ts           (Firebase config & services)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useItems.ts           (Hook para itens)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useFirestore.ts       (Hook Firestore)
‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îÇ       ‚îî‚îÄ‚îÄ Item.ts               (Tipos TypeScript)
‚îú‚îÄ‚îÄ app.json                      (Expo config)
‚îú‚îÄ‚îÄ firebase.json                 (Firebase config)
‚îî‚îÄ‚îÄ App.tsx
```

**Depend√™ncias principais:**

- `firebase` - SDK Firebase
- `@react-native-firebase/app` - Firebase core
- `@react-native-firebase/firestore` - Firestore
- `expo` - Build e distribui√ß√£o

### 2.3 Frontend Web - React (Vercel)

```
shopping-list-web/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ItemList.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ItemInput.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ItemCard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ClearButton.tsx
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HomePage.tsx
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ firebase.ts           (Firebase config)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useItems.ts
‚îÇ   ‚îî‚îÄ‚îÄ styles/
‚îÇ       ‚îî‚îÄ‚îÄ global.css
‚îú‚îÄ‚îÄ firebase.json                 (Firebase config)
‚îú‚îÄ‚îÄ vercel.json                   (Vercel config)
‚îî‚îÄ‚îÄ App.tsx
```

**Depend√™ncias principais:**

- `firebase` - SDK Firebase (Web)
- `react` - Framework
- `vite` - Build tool

---

## 3. Fluxo de Dados

### 3.1 Adicionar Item (Online/Offline - Autom√°tico)

```
1. Usu√°rio digita item ‚Üí ItemInput
2. ItemInput ‚Üí firebase.firestore().collection('items').add()
3. Firebase SDK adiciona localmente (cache)
4. Interface atualizada instantaneamente (optimistic update)
5. Firebase sincroniza com servidor quando online
6. Outros clientes recebem atualiza√ß√£o em tempo real
```

**Vantagens:**

- ‚úÖ Funciona offline automaticamente
- ‚úÖ Sincroniza√ß√£o transparente
- ‚úÖ Sem c√≥digo de sincroniza√ß√£o manual
- ‚úÖ Real-time out-of-the-box

### 3.2 Sincroniza√ß√£o em Tempo Real (Nativa)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Cliente A‚îÇ                   ‚îÇ Cliente B‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ                              ‚îÇ
     ‚îÇ firestore.add()              ‚îÇ
     ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
     ‚îÇ                   ‚Üì          ‚îÇ
     ‚îÇ          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
     ‚îÇ          ‚îÇ  Firestore  ‚îÇ     ‚îÇ
     ‚îÇ          ‚îÇ  (Cloud)    ‚îÇ     ‚îÇ
     ‚îÇ          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
     ‚îÇ                   ‚îÇ          ‚îÇ
     ‚îÇ    Real-time Listener        ‚îÇ
     ‚îÇ  ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
     ‚îÇ           ‚îÇ                  ‚îÇ
     ‚îÇ Atualizado‚îÇ         Atualizado
```

### 3.3 Opera√ß√µes CRUD

```typescript
// Adicionar item
await firestore().collection("items").add({
  name: "Leite",
  createdAt: new Date(),
  deleted: false,
});

// Listar itens (com listener real-time)
firestore()
  .collection("items")
  .where("deleted", "==", false)
  .orderBy("createdAt", "desc")
  .onSnapshot((snapshot) => {
    const items = snapshot.docs.map((doc) => ({
      id: doc.id,
      ...doc.data(),
    }));
    updateUI(items);
  });

// Remover item (soft delete)
await firestore().collection("items").doc(itemId).update({
  deleted: true,
  updatedAt: new Date(),
});

// Limpar lista
const batch = firestore().batch();
snapshot.docs.forEach((doc) => {
  batch.update(doc.ref, { deleted: true });
});
await batch.commit();
```

---

## 4. Decis√µes Arquiteturais

### 4.1 Tecnologias Escolhidas

| Componente           | Tecnologia       | Justificativa                                   | Custo   |
| -------------------- | ---------------- | ----------------------------------------------- | ------- |
| Backend/Database     | Firebase         | Serverless, real-time, offline-first nativo     | R$ 0,00 |
| Hospedagem Web       | Vercel           | Deploy autom√°tico, CDN global, SSL gr√°tis       | R$ 0,00 |
| Mobile Framework     | React Native     | C√≥digo compartilhado iOS/Android                | R$ 0,00 |
| Mobile Build/Deploy  | Expo             | Build na nuvem, OTA updates, distribui√ß√£o f√°cil | R$ 0,00 |
| Frontend Web         | React + Vite     | R√°pido, moderno, otimizado                      | R$ 0,00 |
| Autentica√ß√£o         | Firebase Auth    | Integrado, seguro, m√∫ltiplos providers          | R$ 0,00 |
| Storage (se needed)  | Firebase Storage | Armazenamento de arquivos integrado             | R$ 0,00 |
| Analytics (opcional) | Firebase         | Analytics gratuito integrado                    | R$ 0,00 |

**Total de custos: R$ 0,00 / m√™s** üéâ

### 4.2 Padr√µes de Design

#### 4.2.1 Frontend (Mobile e Web)

- **Component Pattern:** Componentes reutiliz√°veis React
- **Custom Hooks:** L√≥gica reutiliz√°vel (`useItems`, `useFirestore`)
- **Observer Pattern:** Firebase listeners para real-time
- **Optimistic Update:** Firebase SDK gerencia automaticamente
- **Offline-First:** Persist√™ncia local autom√°tica do Firebase

#### 4.2.2 Firebase

- **NoSQL Document Database:** Firestore collections/documents
- **Real-time Listeners:** onSnapshot para sincroniza√ß√£o
- **Security Rules:** Valida√ß√£o no servidor
- **Batch Operations:** Opera√ß√µes em lote para performance

### 4.3 Compara√ß√£o: Arquitetura Anterior vs Nova

| Aspecto            | Spring Boot + PostgreSQL     | Firebase + Vercel             |
| ------------------ | ---------------------------- | ----------------------------- |
| **Custo**          | Servidor pago (~R$20-50/m√™s) | **R$ 0,00**                   |
| **Manuten√ß√£o**     | Alta (servidor, DB, deploy)  | **Zero (gerenciado)**         |
| **Escalabilidade** | Manual                       | **Autom√°tica**                |
| **Real-time**      | WebSocket (complexo)         | **Nativo (simples)**          |
| **Offline**        | Implementa√ß√£o manual         | **Nativo (autom√°tico)**       |
| **Setup inicial**  | Complexo (~2-3 dias)         | **R√°pido (~2-3 horas)**       |
| **Deploy**         | Manual (CI/CD necess√°rio)    | **Autom√°tico (git push)**     |
| **Backup**         | Manual                       | **Autom√°tico**                |
| **SSL/HTTPS**      | Configura√ß√£o necess√°ria      | **Inclu√≠do**                  |
| **CDN**            | N√£o inclu√≠do                 | **Global CDN inclu√≠do**       |
| **Logs/Monitor**   | Implementar                  | **Firebase Console inclu√≠do** |

### 4.4 Vantagens da Nova Arquitetura

‚úÖ **Zero custos operacionais**
‚úÖ **Sem servidor para gerenciar**
‚úÖ **Real-time sincroniza√ß√£o nativa**
‚úÖ **Offline-first autom√°tico**
‚úÖ **Escalabilidade autom√°tica**
‚úÖ **Deploy em segundos**
‚úÖ **SSL e CDN inclu√≠dos**
‚úÖ **Backup autom√°tico**
‚úÖ **Menor complexidade de c√≥digo**
‚úÖ **Ideal para MVP e valida√ß√£o**

---

## 5. Limites do Plano Gratuito (Firebase Spark)

### 5.1 Firestore

| Recurso               | Limite Gratuito | Suficiente para            |
| --------------------- | --------------- | -------------------------- |
| Leituras/dia          | 50.000          | ~2.000 usu√°rios ativos/dia |
| Escritas/dia          | 20.000          | ~800 atualiza√ß√µes/hora     |
| Exclus√µes/dia         | 20.000          | ~800 exclus√µes/hora        |
| Armazenamento         | 1 GB            | ~1 milh√£o de documentos    |
| Transfer√™ncia de rede | 10 GB/m√™s       | ~300.000 opera√ß√µes/m√™s     |

### 5.2 Vercel

| Recurso         | Limite Gratuito | Suficiente para       |
| --------------- | --------------- | --------------------- |
| Bandwidth       | 100 GB/m√™s      | ~100.000 visitas/m√™s  |
| Builds          | Ilimitados      | Deploy a cada commit  |
| Serverless Exec | 100 GB-Horas    | Amplamente suficiente |
| Projetos        | Ilimitados      | Quantos voc√™ quiser   |

### 5.3 Expo

| Recurso      | Limite Gratuito | Suficiente para          |
| ------------ | --------------- | ------------------------ |
| Builds       | Ilimitados      | Builds ilimitados        |
| OTA Updates  | Ilimitados      | Updates over-the-air     |
| Distribui√ß√£o | Gratuito        | TestFlight, Play Console |

### 5.4 Estimativa de Capacidade

**Cen√°rio Realista (Uso Moderado):**

- 100 usu√°rios ativos/dia
- 10 a√ß√µes por usu√°rio/dia
- Total: 1.000 opera√ß√µes/dia
- **Uso: 2% do limite gratuito** ‚úÖ

**Cen√°rio Otimista (Muito Uso):**

- 1.000 usu√°rios ativos/dia
- 20 a√ß√µes por usu√°rio/dia
- Total: 20.000 opera√ß√µes/dia
- **Uso: 40% do limite gratuito** ‚úÖ

**Conclus√£o:** O plano gratuito √© **mais que suficiente** para MVP e primeiros anos de opera√ß√£o!

- **Polling fallback** a cada 30 segundos se WebSocket falhar

#### Offline:

- Todas as opera√ß√µes salvas localmente
- Fila de sincroniza√ß√£o (FIFO)
- Ao reconectar: enviar todas as altera√ß√µes pendentes

### 5.2 Resolu√ß√£o de Conflitos

Como n√£o h√° autentica√ß√£o individual, usamos **Last-Write-Wins (LWW)**:

- Cada item tem timestamp de atualiza√ß√£o
- Em caso de conflito, a altera√ß√£o mais recente prevalece
- Remo√ß√µes t√™m prioridade sobre adi√ß√µes (soft delete tempor√°rio)

```
Cen√°rio de Conflito:
- Device A (offline): adiciona "Leite" √†s 10:00
- Device B (online): adiciona "Leite" √†s 10:05
- Device A reconecta √†s 10:10

Resolu√ß√£o:
- Backend mant√©m item de Device B (mais recente)
- Device A recebe confirma√ß√£o e atualiza
```

---

## 6. Seguran√ßa

### 6.1 Medidas de Seguran√ßa

| Camada           | Medida                | Implementa√ß√£o           |
| ---------------- | --------------------- | ----------------------- |
| Transporte       | HTTPS/WSS             | Certificado SSL/TLS     |
| Input Validation | Sanitiza√ß√£o           | Bean Validation + RegEx |
| SQL Injection    | Prepared Statements   | JPA/Hibernate           |
| XSS              | Escape de HTML        | React auto-escape       |
| Rate Limiting    | Limita√ß√£o de requests | Spring Rate Limiter     |
| CORS             | Cross-Origin          | Spring CORS config      |

### 6.2 Sem Autentica√ß√£o

‚ö†Ô∏è **Nota:** Sistema sem autentica√ß√£o por escolha do cliente.

- Lista √© p√∫blica (qualquer um com URL pode acessar)
- **Recomenda√ß√£o futura:** Adicionar c√≥digo PIN simples para acesso

---

## 7. Escalabilidade

### 7.1 Arquitetura Atual (MVP)

```
[Clientes] ‚Üí [Spring Boot App] ‚Üí [PostgreSQL]
                    ‚Üì
            [WebSocket Server]
```

### 7.2 Escalabilidade Futura

```
[Clientes] ‚Üí [Load Balancer]
                    ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚Üì                       ‚Üì
    [App Server 1]         [App Server 2]
        ‚Üì                       ‚Üì
    [Redis Pub/Sub] ‚Üê ‚Üí [Redis Pub/Sub]
        ‚Üì                       ‚Üì
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
            [PostgreSQL Master]
                    ‚Üì
          [PostgreSQL Replicas]
```

**Melhorias futuras:**

- Cache com Redis
- Load Balancer (Nginx)
- Horizontal scaling do backend
- CDN para assets web
- Database replication

---

## 8. Monitoramento e Logs

### 8.1 Logs

- **Backend:** SLF4J + Logback
- **N√≠veis:** INFO (opera√ß√µes), ERROR (falhas), DEBUG (desenvolvimento)
- **Formato:** JSON para f√°cil parsing

### 8.2 M√©tricas

- Spring Boot Actuator para health checks
- M√©tricas de API (response time, error rate)
- Conex√µes WebSocket ativas

### 8.3 Alertas

- Falhas de sincroniza√ß√£o
- Erros de banco de dados
- Alta lat√™ncia de API

---

## 9. Deployment

### 9.1 Backend

```
Ambiente DEV:
- H2 in-memory database
- Spring Profile: dev
- Port: 8080

Ambiente PROD:
- PostgreSQL
- Spring Profile: prod
- Port: 443 (HTTPS)
- Deploy: Docker container ou JAR
```

### 9.2 Mobile

```
Android:
- Build: APK/AAB
- Store: Google Play ou sideload
- Vers√£o m√≠nima: Android 8.0 (API 26)

iOS:
- Build: IPA
- Store: App Store ou TestFlight
- Vers√£o m√≠nima: iOS 13.0
```

### 9.3 Web

```
Build: npm run build
Deploy:
- Vercel / Netlify (recomendado)
- Nginx + servidor pr√≥prio
Assets: CDN (opcional)
```

---

## 10. Estrutura do Banco de Dados

### 10.1 Tabela: items

```sql
CREATE TABLE items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(200) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL,
    CONSTRAINT name_not_empty CHECK (LENGTH(TRIM(name)) > 0)
);

CREATE INDEX idx_items_deleted_at ON items(deleted_at);
CREATE INDEX idx_items_updated_at ON items(updated_at);
```

**Soft Delete:** Campo `deleted_at` para n√£o perder hist√≥rico imediato

---

## 11. API REST Specification

### 11.1 Endpoints

#### GET /api/items

**Descri√ß√£o:** Retorna todos os itens n√£o deletados

```json
Response 200 OK:
{
  "data": [
    {
      "id": "uuid-v4",
      "name": "Leite",
      "createdAt": "2025-10-16T10:30:00Z",
      "updatedAt": "2025-10-16T10:30:00Z"
    }
  ],
  "count": 1,
  "timestamp": "2025-10-16T10:35:00Z"
}
```

#### POST /api/items

**Descri√ß√£o:** Adiciona novo item

```json
Request Body:
{
  "name": "Arroz"
}

Response 201 Created:
{
  "data": {
    "id": "uuid-v4",
    "name": "Arroz",
    "createdAt": "2025-10-16T10:30:00Z",
    "updatedAt": "2025-10-16T10:30:00Z"
  }
}
```

#### DELETE /api/items/{id}

**Descri√ß√£o:** Remove item espec√≠fico

```json
Response 204 No Content
```

#### DELETE /api/items/clear

**Descri√ß√£o:** Remove todos os itens (nova semana)

```json
Response 200 OK:
{
  "message": "Lista limpa com sucesso",
  "deletedCount": 15
}
```

### 11.2 WebSocket

#### Endpoint: ws://domain/ws/items

**Eventos:**

```json
// Item adicionado
{
  "type": "ITEM_ADDED",
  "data": {
    "id": "uuid",
    "name": "Banana"
  },
  "timestamp": "2025-10-16T10:30:00Z"
}

// Item removido
{
  "type": "ITEM_REMOVED",
  "data": {
    "id": "uuid"
  },
  "timestamp": "2025-10-16T10:30:00Z"
}

// Lista limpa
{
  "type": "LIST_CLEARED",
  "timestamp": "2025-10-16T10:30:00Z"
}
```

---

## 12. Performance

### 12.1 Requisitos

- Adicionar item: < 500ms
- Carregar lista: < 1s
- Sincroniza√ß√£o: < 2s
- Suporte: 500+ itens

### 12.2 Otimiza√ß√µes

- √çndices no banco de dados
- Pagina√ß√£o (se lista > 100 itens)
- Compress√£o Gzip para API
- Lazy loading de componentes
- Memoization no React
- Virtual scrolling para listas grandes

---

## 13. Testes

### 13.1 Backend

- **Unit Tests:** JUnit 5 + Mockito
- **Integration Tests:** Spring Boot Test + TestContainers
- **API Tests:** RestAssured
- **Coverage:** > 80%

### 13.2 Frontend

- **Unit Tests:** Jest + React Testing Library
- **Component Tests:** Storybook
- **E2E Tests:** Detox (mobile) / Cypress (web)
- **Coverage:** > 70%

---

## 14. Diagramas

### 14.1 Diagrama de Sequ√™ncia - Adicionar Item

```
Usu√°rio    Mobile App    Backend    Database    Outro Device
   ‚îÇ           ‚îÇ            ‚îÇ           ‚îÇ            ‚îÇ
   ‚îÇ  digita   ‚îÇ            ‚îÇ           ‚îÇ            ‚îÇ
   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ            ‚îÇ           ‚îÇ            ‚îÇ
   ‚îÇ           ‚îÇ  POST      ‚îÇ           ‚îÇ            ‚îÇ
   ‚îÇ           ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ           ‚îÇ            ‚îÇ
   ‚îÇ           ‚îÇ            ‚îÇ  INSERT   ‚îÇ            ‚îÇ
   ‚îÇ           ‚îÇ            ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ            ‚îÇ
   ‚îÇ           ‚îÇ            ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§            ‚îÇ
   ‚îÇ           ‚îÇ            ‚îÇ  WS Notify‚îÇ            ‚îÇ
   ‚îÇ           ‚îÇ            ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
   ‚îÇ           ‚îÇ  201 OK    ‚îÇ           ‚îÇ            ‚îÇ
   ‚îÇ           ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§           ‚îÇ            ‚îÇ
   ‚îÇ  atualiza ‚îÇ            ‚îÇ           ‚îÇ  atualiza  ‚îÇ
   ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§            ‚îÇ           ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
```

---

**Fim do Documento**
